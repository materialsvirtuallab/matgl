
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>MatGL (Materials Graph Library) &#8212; matgl  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="matgl-materials-graph-library">
<h1>MatGL (Materials Graph Library)<a class="headerlink" href="#matgl-materials-graph-library" title="Permalink to this heading">¶</a></h1>
<p><a class="reference external" href="https://github.com/materialsvirtuallab/matgl/blob/main/LICENSE"><img alt="GitHub license" src="https://img.shields.io/github/license/materialsvirtuallab/matgl" /></a>
<a class="reference external" href="https://github.com/materialsvirtuallab/matgl/workflows/Linting/badge.svg"><img alt="Linting" src="https://github.com/materialsvirtuallab/matgl/workflows/Linting/badge.svg" /></a>
<a class="reference external" href="https://github.com/materialsvirtuallab/matgl/workflows/Testing/badge.svg"><img alt="Testing" src="https://github.com/materialsvirtuallab/matgl/workflows/Testing%20-%20main/badge.svg" /></a>
<a class="reference external" href="https://pepy.tech/project/matgl"><img alt="Downloads" src="https://pepy.tech/badge/matgl" /></a></p>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction">Introduction</a></p></li>
<li><p><a class="reference internal" href="#status">Status</a></p></li>
<li><p><a class="reference internal" href="#architectures">Architectures</a></p></li>
<li><p><a class="reference internal" href="#installation">Installation</a></p></li>
<li><p><a class="reference internal" href="#usage">Usage</a></p></li>
<li><p><a class="reference internal" href="#api-docs">API Docs</a></p></li>
<li><p><a class="reference internal" href="#developer-s-guide">Developer’s Guide</a></p></li>
<li><p><a class="reference internal" href="#references">References</a></p></li>
<li><p><a class="reference internal" href="#faqs">FAQs</a></p></li>
<li><p><a class="reference internal" href="#acknowledgments">Acknowledgements</a></p></li>
</ul>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>MatGL (Materials Graph Library) is a graph deep learning library for materials science. Mathematical graphs are a
natural representation for a collection of atoms (e.g., molecules or crystals). Graph deep learning models have been
shown to consistently deliver exceptional performance as surrogate models for the prediction of materials properties.</p>
<p>In this repository, we have reimplemented the original Tensorflow <a class="reference external" href="https://www.nature.com/articles/s43588-022-00349-3" title="M3GNet paper">MatErials 3-body Graph Network (m3gnet)</a>
and its predecessor, <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.chemmater.9b01294" title="MEGNet paper">MEGNet</a>, using the <a class="reference external" href="https://www.dgl.ai" title="DGL website">Deep Graph Library (DGL)</a> and PyTorch.
The goal is to improve the usability, extensibility and scalability of these models. Here are some key improvements
over the TF implementations:</p>
<ul class="simple">
<li><p>A more intuitive API and class structure based on DGL.</p></li>
<li><p>Multi-GPU support via PyTorch Lightning. A training utility module has been developed.</p></li>
</ul>
<p>This effort is a collaboration between the <a class="reference external" href="http://materialsvirtuallab.org" title="MAVRL website">Materials Virtual Lab</a> and Intel Labs (Santiago Miret, Marcel
Nassar, Carmelo Gonzales). Please refer to the <a class="reference external" href="https://matgl.ai" title="MatGL Documentation">official documentation</a> for more details.</p>
</section>
<section id="status">
<h2>Status<a class="headerlink" href="#status" title="Permalink to this heading">¶</a></h2>
<p>Major milestones are summarized below. Please refer to <a class="reference external" href="https://matgl.ai/changes" title="Changelog">change log</a> for details.</p>
<ul class="simple">
<li><p>v0.5.1 (Jun 9 2023): Model versioning implemented.</p></li>
<li><p>v0.5.0 (Jun 8 2023): Simplified saving and loading of models. Now models can be loaded with one line of code!</p></li>
<li><p>v0.4.0 (Jun 7 2023): Near feature parity with original TF implementations. Re-trained M3Gnet universal potential now
available.</p></li>
<li><p>v0.1.0 (Feb 16 2023): Initial implementations of M3GNet and MEGNet architectures have been completed. Expect
bugs!</p></li>
</ul>
</section>
<section id="architectures">
<h2>Architectures<a class="headerlink" href="#architectures" title="Permalink to this heading">¶</a></h2>
<img src="https://github.com/materialsvirtuallab/matgl/blob/main/assets/MxGNet.png?raw=true" alt="m3gnet_schematic" width="50%">
</section>
<section id="megnet">
<h2>MEGNet<a class="headerlink" href="#megnet" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.chemmater.9b01294" title="MEGNet paper">MatErials Graph Network (MEGNet)</a> is an implementation of DeepMind’s <a class="reference external" href="https://arxiv.org/abs/1806.01261" title="Deepmind's paper">graph networks</a> for
machine learning in materials science. We have demonstrated its success in achieving low prediction errors in a broad
array of properties in both <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.chemmater.9b01294" title="MEGNet paper">molecules and crystals</a>. New releases have included our recent work on
<a class="reference external" href="https://www.nature.com/articles/s43588-020-00002-x" title="mfi MEGNet paper">multi-fidelity materials property modeling</a>. Figure 1 shows the sequential update steps of the graph
network, whereby bonds, atoms, and global state attributes are updated using information from each other, generating an output graph.</p>
</section>
<section id="m3gnet">
<h2>M3GNet<a class="headerlink" href="#m3gnet" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://www.nature.com/articles/s43588-022-00349-3" title="M3GNet paper">M3GNet</a> is a new materials graph neural network architecture that incorporates 3-body interactions in MEGNet. An additional difference is the addition of the coordinates for atoms and
the 3×3 lattice matrix in crystals, which are necessary for obtaining tensorial quantities such as forces and
stresses via auto-differentiation. As a framework, M3GNet has diverse applications, including:</p>
<ul class="simple">
<li><p><strong>Interatomic potential development.</strong> With the same training data, M3GNet performs similarly to state-of-the-art
machine learning interatomic potentials (MLIPs). However, a key feature of a graph representation is its
flexibility to scale to diverse chemical spaces. One of the key accomplishments of M3GNet is the development of a
<em>universal IP</em> that can work across the entire periodic table of the elements by training on relaxations performed
in the <a class="reference external" href="http://materialsproject.org" title="Materials Project">Materials Project</a>.</p></li>
<li><p><strong>Surrogate models for property predictions.</strong> Like the previous MEGNet architecture, M3GNet can be used to develop
surrogate models for property predictions, achieving in many cases accuracies that are better or similar to other
state-of-the-art ML models.</p></li>
</ul>
<p>For detailed performance benchmarks, please refer to the publications in the <a class="reference internal" href="#references">References</a> section.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading">¶</a></h2>
<p>Matgl can be installed via pip for the latest stable version:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>matgl
</pre></div>
</div>
<p>For the latest dev version, please clone this repo and install using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>setup.py<span class="w"> </span>-e<span class="w"> </span>.
</pre></div>
</div>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p>Pre-trained M3GNet universal potential and MEGNet models for the Materials Project formation energy and
multi-fidelity band gap are now available. Users who just want to use the models out of the box should use the newly
implemented <code class="docutils literal notranslate"><span class="pre">matgl.load_model</span></code> convenience method. The following is an example of a prediction of the formation
energy for CsCl.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pymatgen.core</span> <span class="kn">import</span> <span class="n">Lattice</span><span class="p">,</span> <span class="n">Structure</span>
<span class="kn">import</span> <span class="nn">matgl</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">matgl</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;MEGNet-MP-2018.6.1-Eform&quot;</span><span class="p">)</span>

<span class="c1"># This is the structure obtained from the Materials Project.</span>
<span class="n">struct</span> <span class="o">=</span> <span class="n">Structure</span><span class="o">.</span><span class="n">from_spacegroup</span><span class="p">(</span><span class="s2">&quot;Pm-3m&quot;</span><span class="p">,</span> <span class="n">Lattice</span><span class="o">.</span><span class="n">cubic</span><span class="p">(</span><span class="mf">4.1437</span><span class="p">),</span> <span class="p">[</span><span class="s2">&quot;Cs&quot;</span><span class="p">,</span> <span class="s2">&quot;Cl&quot;</span><span class="p">],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span>
<span class="n">eform</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_structure</span><span class="p">(</span><span class="n">struct</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The predicted formation energy for CsCl is </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">eform</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> eV/atom.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain a listing of available pre-trained models,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matgl</span>
<span class="nb">print</span><span class="p">(</span><span class="n">matgl</span><span class="o">.</span><span class="n">get_available_pretrained_models</span><span class="p">())</span>
</pre></div>
</div>
<section id="jupyter-tutorials">
<h3>Jupyter Tutorials<a class="headerlink" href="#jupyter-tutorials" title="Permalink to this heading">¶</a></h3>
<p>We have written several <a class="reference internal" href="#examples"><span class="xref myst">Jupyter notebooks</span></a> on the use of MatGL. These notebooks can be run on <a class="reference external" href="http://colab.google.com" title="Google Colab">Google
Colab</a>. This will be the primary form of tutorials.</p>
</section>
</section>
<section id="api-docs">
<h2>API Docs<a class="headerlink" href="#api-docs" title="Permalink to this heading">¶</a></h2>
<p>The Sphinx-generated API docs are available <a class="reference external" href="https://materialsvirtuallab.github.io/matgl/matgl.html" title="MatGL API docs">here</a>.</p>
</section>
<section id="developer-s-guide">
<h2>Developer’s Guide<a class="headerlink" href="#developer-s-guide" title="Permalink to this heading">¶</a></h2>
<p>A basic <a class="reference internal" href="developer.html"><span class="std std-doc">developer’s guide</span></a> has been written to outline the key design elements of matgl. This serves
as a guiding documentation for developers wishing to train and contribute matgl models.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">¶</a></h2>
<p>A MatGL publication is currently being written. For now, pls refer to the CITATION.cff file for the citation
information. If you are using any of the pretrained models, please cite the relevant works below:</p>
<blockquote>
<div><h3 class="rubric" id="id1">MEGNet</h3>
<p>Chen, C.; Ye, W.; Zuo, Y.; Zheng, C.; Ong, S. P. <em>Graph Networks as a Universal Machine Learning Framework for
Molecules and Crystals.</em> Chem. Mater. 2019, 31 (9), 3564–3572. DOI: <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.chemmater.9b01294" title="MEGNet paper">10.1021/acs.chemmater.9b01294</a>.</p>
</div></blockquote>
<blockquote>
<div><h3 class="rubric" id="multi-fidelity-megnet">Multi-fidelity MEGNet</h3>
<p>Chen, C.; Zuo, Y.; Ye, W.; Li, X.; Ong, S. P. <em>Learning Properties of Ordered and Disordered Materials from
Multi-Fidelity Data.</em> Nature Computational Science, 2021, 1, 46–53. DOI: <a class="reference external" href="https://www.nature.com/articles/s43588-020-00002-x" title="mfi MEGNet paper">10.1038/s43588-020-00002-x</a>.</p>
</div></blockquote>
<blockquote>
<div><h3 class="rubric" id="id2">M3GNet</h3>
<p>Chen, C., Ong, S.P. <em>A universal graph deep learning interatomic potential for the periodic table.</em> Nature
Computational Science, 2023, 2, 718–728. DOI: <a class="reference external" href="https://www.nature.com/articles/s43588-022-00349-3" title="M3GNet paper">10.1038/s43588-022-00349-3</a>.</p>
</div></blockquote>
</section>
<section id="faqs">
<h2>FAQs<a class="headerlink" href="#faqs" title="Permalink to this heading">¶</a></h2>
<ol class="arabic">
<li><p>The <code class="docutils literal notranslate"><span class="pre">M3GNet-MP-2021.2.8-PES</span></code> differs from the original tensorflow (TF) implementation!</p>
<p>Answer: <code class="docutils literal notranslate"><span class="pre">M3GNet-MP-2021.2.8-PES</span></code> is a refitted model with some data improvements and minor architectural changes.
Porting over the weights from the TF version to DGL/PyTorch is non-trivial. We have performed reasonable benchmarking
to ensure that the new implementation reproduces the broad error characteristics of the original TF implementation
(see <a class="reference internal" href="#examples"><span class="xref myst">examples</span></a>). However, it is not expected to reproduce the TF version exactly. This refitted model
serves as a baseline for future model improvements. We do not believe there is value in expending the resources
to reproduce the TF version exactly.</p>
</li>
<li><p>I am getting errors with <code class="docutils literal notranslate"><span class="pre">matgl.load_model()</span></code>!</p>
<p>Answer: The most likely reason is that you have a cached older version of the model. We often refactor models to
ensure the best implementation. This can usually be solved by updating your matgl to the latest version
and clearing your cache using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>matgl<span class="w"> </span>--upgrade
python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import matgl; matgl.clear_cache()&quot;</span>
</pre></div>
</div>
<p>On the next run, the latest model will be downloaded. With effect from v0.5.2, we have implemented a model
versioning scheme that will detect code vs model version conflicts and alert the user of such problems.</p>
</li>
</ol>
</section>
<section id="acknowledgments">
<h2>Acknowledgments<a class="headerlink" href="#acknowledgments" title="Permalink to this heading">¶</a></h2>
<p>This work was primarily supported by the <a class="reference external" href="http://materialsproject.org" title="Materials Project">Materials Project</a>, funded by the U.S. Department of Energy, Office of
Science, Office of Basic Energy Sciences, Materials Sciences and Engineering Division under contract no.
DE-AC02-05-CH11231: Materials Project program KC23MP. This work used the Expanse supercomputing cluster at the Extreme
Science and Engineering Discovery Environment (XSEDE), which is supported by National Science Foundation grant number
ACI-1548562.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">matgl</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Materials Virtual Lab.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/index.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>